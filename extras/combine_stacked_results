#!/usr/bin/env python3

import os
import json
import argparse
import numpy as np

parser = argparse.ArgumentParser()
parser.add_argument("-j", "--jsons", action="store",
                    help="Name of the directory where JSON files are present")
parser.add_argument("-o", "--output", action="store",
                    help="Name of the output file")

args = parser.parse_args()


listdir = os.listdir(args.jsons)

stack_dict = {}
bf_array = np.array([])
joint_bf_array = []
for jsonfile in listdir:
    with open(os.path.join(args.jsons, jsonfile), 'r') as f:
        this_data = json.load(f)
        joint_bf_array += this_data['joint_bf_array']


stack_dict['all_bf'] = this_data['all_bf']
stack_dict['all_bf_err'] = this_data['all_bf_err']
stack_dict['joint_bf'] = this_data['joint_bf']
stack_dict['joint_bf_array'] = joint_bf_array
stack_dict["ref_eos"] = this_data['ref_eos']
stack_dict["target_eos"] = this_data['target_eos']

with open(args.output, 'w') as f:
        json.dump(stack_dict, f, indent=2, sort_keys=True)
